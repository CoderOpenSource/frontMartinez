import{a as z}from"./chunk-VQFNXLW7.js";import{a as k,b as T,e as D,g as L,h as W,i as A,k as N}from"./chunk-BTD7GRPP.js";import{b as V}from"./chunk-ZBLQCJ4V.js";import{$a as g,Da as l,Ea as H,Ra as h,Rb as F,Sb as P,Ta as p,Ub as O,Va as r,Wa as o,Xa as S,_a as x,a as y,ab as c,ba as E,e as j,fb as d,gb as w,hb as M,ib as C,jb as f,ka as m,kb as b,la as _,lb as v,nb as I}from"./chunk-IG4KVHXC.js";var u=j(z());function B(n,s){n&1&&(r(0,"div",2),S(1,"div",3),o())}function $(n,s){n&1&&(r(0,"span"),d(1,", "),o())}function q(n,s){if(n&1&&(r(0,"span"),d(1),h(2,$,2,0,"span",17),o()),n&2){let t=s.$implicit,e=s.index,i=c().$implicit,a=c(2);l(),M(" ",a.getEspecialidadNombre(t),""),l(),p("ngIf",e<i.especialidadesIds.length-1)}}function G(n,s){if(n&1){let t=x();r(0,"tr",22)(1,"td",20),d(2),o(),r(3,"td",20),d(4),o(),r(5,"td",20),d(6),o(),r(7,"td",20)(8,"input",23),g("change",function(){let i=m(t).$implicit,a=c(4);return _(a.toggleDeleteSelection(i.id))}),o(),r(9,"button",24),g("click",function(){let i=m(t).$implicit,a=c(4);return _(a.editHorario(i))}),d(10," Editar "),o()()()}if(n&2){let t=s.$implicit;l(2),w(t.dia),l(2),w(t.horaInicio),l(2),w(t.horaFin)}}function R(n,s){if(n&1&&(r(0,"table",18)(1,"thead")(2,"tr",19)(3,"th",20),d(4,"D\xEDa"),o(),r(5,"th",20),d(6,"Hora Inicio"),o(),r(7,"th",20),d(8,"Hora Fin"),o(),r(9,"th",20),d(10,"Acciones"),o()()(),r(11,"tbody"),h(12,G,11,3,"tr",21),o()()),n&2){let t=c().$implicit,e=c(2);l(12),p("ngForOf",e.horariosPorMedico[t.id])}}function J(n,s){n&1&&(r(0,"p",25),d(1," No hay horarios para este m\xE9dico. "),o())}function K(n,s){if(n&1){let t=x();r(0,"button",26),g("click",function(){m(t);let i=c(3);return _(i.deleteSelectedHorarios())}),d(1," Eliminar Seleccionados "),o()}}function Q(n,s){if(n&1&&(r(0,"div",10)(1,"h2",11),d(2),o(),r(3,"p",12),d(4," Especialidad(es): "),h(5,q,3,2,"span",13),o(),h(6,R,13,1,"table",14)(7,J,2,0,"p",15)(8,K,2,0,"button",16),o()),n&2){let t=s.$implicit,e=c(2);l(2),C(" ",t.nombre," ",t.apellido," "),l(3),p("ngForOf",t.especialidadesIds),l(),p("ngIf",e.horariosPorMedico[t.id]&&e.horariosPorMedico[t.id].length>0),l(),p("ngIf",!e.horariosPorMedico[t.id]||e.horariosPorMedico[t.id].length===0),l(),p("ngIf",e.selectedForDeletion.size>0)}}function U(n,s){if(n&1&&(r(0,"option",39),d(1),o()),n&2){let t=s.$implicit;p("value",t.id),l(),C("",t.nombre," ",t.apellido,"")}}function X(n,s){if(n&1){let t=x();r(0,"div",27)(1,"div",28)(2,"h2",29),d(3),o(),r(4,"div",30)(5,"label",31),d(6,"Seleccionar M\xE9dico"),o(),r(7,"select",32),v("ngModelChange",function(i){m(t);let a=c(2);return b(a.selectedMedicoId,i)||(a.selectedMedicoId=i),_(i)}),h(8,U,2,3,"option",33),o()(),r(9,"div",30)(10,"label",31),d(11,"D\xEDa"),o(),r(12,"input",34),v("ngModelChange",function(i){m(t);let a=c(2);return b(a.selectedHorario.dia,i)||(a.selectedHorario.dia=i),_(i)}),o()(),r(13,"div",30)(14,"label",31),d(15,"Hora Inicio"),o(),r(16,"input",35),v("ngModelChange",function(i){m(t);let a=c(2);return b(a.selectedHorario.horaInicio,i)||(a.selectedHorario.horaInicio=i),_(i)}),o()(),r(17,"div",30)(18,"label",31),d(19,"Hora Fin"),o(),r(20,"input",35),v("ngModelChange",function(i){m(t);let a=c(2);return b(a.selectedHorario.horaFin,i)||(a.selectedHorario.horaFin=i),_(i)}),o()(),r(21,"div",36)(22,"button",37),g("click",function(){m(t);let i=c(2);return _(i.saveHorario())}),d(23),o(),r(24,"button",38),g("click",function(){m(t);let i=c(2);return _(i.closeModal())}),d(25," Cancelar "),o()()()()}if(n&2){let t=c(2);l(3),M(" ",t.isEditMode?"Editar Horario":"A\xF1adir Horario"," "),l(4),f("ngModel",t.selectedMedicoId),l(),p("ngForOf",t.medicos),l(4),f("ngModel",t.selectedHorario.dia),l(4),f("ngModel",t.selectedHorario.horaInicio),l(4),f("ngModel",t.selectedHorario.horaFin),l(3),M(" ",t.isEditMode?"Actualizar":"Guardar"," ")}}function Y(n,s){if(n&1){let t=x();r(0,"div",4)(1,"h1",5),d(2,"Gestionar Horarios de M\xE9dicos"),o(),r(3,"div",6)(4,"button",7),g("click",function(){m(t);let i=c();return _(i.openAddHorarioModal())}),d(5," A\xF1adir Horario "),o()(),h(6,Q,9,6,"div",8)(7,X,26,7,"div",9),o()}if(n&2){let t=c();l(6),p("ngForOf",t.medicos),l(),p("ngIf",t.showModal)}}var re=(()=>{let s=class s{constructor(e){this.http=e,this.isLoading=!1,this.medicos=[],this.especialidades=[],this.horariosPorMedico={},this.selectedHorario={id:0,dia:"",horaInicio:"",horaFin:"",medicoId:0},this.selectedMedicoId=null,this.isEditMode=!1,this.showModal=!1,this.selectedForDeletion=new Set}ngOnInit(){this.loadMedicos(),this.loadEspecialidades()}loadMedicos(){this.isLoading=!0,this.http.get("http://143.198.147.110/api/medicos").subscribe(e=>{this.medicos=e,this.loadHorariosForMedicos()},e=>{this.isLoading=!1,console.error("Error loading medicos",e)})}loadEspecialidades(){this.http.get("http://143.198.147.110/api/especialidades").subscribe(e=>{this.especialidades=e,this.isLoading=!1},e=>{this.isLoading=!1,console.error("Error loading especialidades",e)})}loadHorariosForMedicos(){this.medicos.forEach(e=>{this.http.get(`http://143.198.147.110/api/horarios/medico/${e.id}`).subscribe(i=>{this.horariosPorMedico[e.id]=i},i=>{this.isLoading=!1,console.error(`Error loading horarios for medico ${e.id}`,i)})})}getEspecialidadNombre(e){let i=this.especialidades.find(a=>a.id===e);return i?i.nombre:""}openAddHorarioModal(){this.selectedHorario={id:0,dia:"",horaInicio:"",horaFin:"",medicoId:this.selectedMedicoId||0},this.isEditMode=!1,this.showModal=!0}editHorario(e){this.selectedHorario=y({},e),this.isEditMode=!0,this.showModal=!0}deleteSelectedHorarios(){u.default.fire({title:"\xBFEliminar horarios seleccionados?",text:"Esta acci\xF3n no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar"}).then(e=>{if(e.isConfirmed){let i=Array.from(this.selectedForDeletion).map(a=>this.http.delete(`http://143.198.147.110/api/horarios/${a}`).toPromise());Promise.all(i).then(()=>{u.default.fire("Eliminado","Los horarios seleccionados fueron eliminados correctamente.","success"),this.loadHorariosForMedicos(),this.selectedForDeletion.clear()}).catch(a=>{console.error("Error deleting horarios",a),u.default.fire("Error","Hubo un error al eliminar los horarios.","error")})}})}toggleDeleteSelection(e){this.selectedForDeletion.has(e)?this.selectedForDeletion.delete(e):this.selectedForDeletion.add(e)}saveHorario(){if(!this.selectedMedicoId){u.default.fire("Error","Debe seleccionar un m\xE9dico.","error");return}this.selectedHorario.medicoId=this.selectedMedicoId;let e=this.isEditMode?`http://143.198.147.110/api/horarios/${this.selectedHorario.id}`:`http://143.198.147.110/api/horarios/medico/${this.selectedMedicoId}`;(this.isEditMode?this.http.put(e,this.selectedHorario):this.http.post(e,this.selectedHorario)).subscribe(()=>{this.loadHorariosForMedicos(),this.showModal=!1,u.default.fire(this.isEditMode?"Actualizado":"Creado",`El horario ha sido ${this.isEditMode?"actualizado":"creado"} correctamente.`,"success")},a=>{console.error("Error saving horario",a),u.default.fire("Error","Hubo un error al guardar el horario.","error")})}closeModal(){this.showModal=!1}};s.\u0275fac=function(i){return new(i||s)(H(V))},s.\u0275cmp=E({type:s,selectors:[["app-horarios"]],standalone:!0,features:[I],decls:2,vars:2,consts:[["class","spinner-container",4,"ngIf"],["class","container mx-auto px-4 py-8",4,"ngIf"],[1,"spinner-container"],[1,"spinner"],[1,"container","mx-auto","px-4","py-8"],[1,"text-3xl","font-bold","mb-8","text-center","text-gray-800"],[1,"flex","justify-center","mb-6"],[1,"bg-green-500","text-white","px-4","py-2","rounded-lg","hover:bg-green-600",3,"click"],["class","mb-8 p-6 bg-white shadow-lg rounded-lg border border-gray-200",4,"ngFor","ngForOf"],["class","fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 flex items-center justify-center",4,"ngIf"],[1,"mb-8","p-6","bg-white","shadow-lg","rounded-lg","border","border-gray-200"],[1,"text-2xl","font-semibold","text-gray-700","mb-2"],[1,"text-gray-600","italic","mb-4"],[4,"ngFor","ngForOf"],["class","min-w-full bg-white border-collapse shadow-md rounded-lg",4,"ngIf"],["class","text-gray-600 mt-4",4,"ngIf"],["class","bg-red-500 text-white px-4 py-2 rounded-lg mt-4 hover:bg-red-600",3,"click",4,"ngIf"],[4,"ngIf"],[1,"min-w-full","bg-white","border-collapse","shadow-md","rounded-lg"],[1,"bg-gray-800","text-white"],[1,"p-4","border"],["class","hover:bg-gray-100",4,"ngFor","ngForOf"],[1,"hover:bg-gray-100"],["type","checkbox",1,"mr-2",3,"change"],[1,"bg-blue-500","text-white","px-3","py-1","rounded","hover:bg-blue-600",3,"click"],[1,"text-gray-600","mt-4"],[1,"bg-red-500","text-white","px-4","py-2","rounded-lg","mt-4","hover:bg-red-600",3,"click"],[1,"fixed","top-0","left-0","w-full","h-full","bg-black","bg-opacity-50","flex","items-center","justify-center"],[1,"bg-white","p-6","rounded-lg","shadow-md","w-full","max-w-lg"],[1,"text-2xl","font-bold","mb-4","text-center"],[1,"mb-4"],[1,"block","font-bold","text-gray-700","mb-2"],[1,"w-full","px-3","py-2","border","rounded-lg",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["placeholder","D\xEDa de la semana",1,"w-full","px-3","py-2","border","rounded-lg",3,"ngModelChange","ngModel"],["type","time",1,"w-full","px-3","py-2","border","rounded-lg",3,"ngModelChange","ngModel"],[1,"flex","justify-between","mt-4"],[1,"bg-blue-500","text-white","px-4","py-2","rounded-lg","hover:bg-blue-600",3,"click"],[1,"bg-gray-500","text-white","px-4","py-2","rounded-lg","hover:bg-gray-600",3,"click"],[3,"value"]],template:function(i,a){i&1&&h(0,B,2,0,"div",0)(1,Y,8,2,"div",1),i&2&&(p("ngIf",a.isLoading),l(),p("ngIf",!a.isLoading))},dependencies:[O,F,P,N,W,A,k,L,T,D],styles:[".spinner-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#000c;display:flex;justify-content:center;align-items:center;z-index:1000}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid #ffffff;border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:20px}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #dee2e6;padding:12px;text-align:left}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f8f9fa}button[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-weight:700;cursor:pointer;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{opacity:.9}@media (max-width: 768px){table[_ngcontent-%COMP%]{font-size:14px}button[_ngcontent-%COMP%]{width:100%;margin-top:10px}}"]});let n=s;return n})();export{re as HorariosComponent};

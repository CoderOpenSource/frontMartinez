import{a as M}from"./chunk-VQFNXLW7.js";import{b as O}from"./chunk-ZBLQCJ4V.js";import{$a as C,Da as s,Ea as _,Ra as f,Rb as E,Sb as I,Ta as p,Ub as S,Va as i,Wa as t,Xa as b,_a as v,ab as g,ba as x,e as y,fb as n,gb as d,ka as h,la as u,nb as P}from"./chunk-IG4KVHXC.js";var m=y(M());function w(o,c){o&1&&(i(0,"div",2),b(1,"div",3),t())}function T(o,c){o&1&&(i(0,"div",8),n(1," NO TIENES PACIENTES REGISTRADOS A\xDAN "),t())}function A(o,c){if(o&1){let r=v();i(0,"tr")(1,"td"),n(2),t(),i(3,"td"),n(4),t(),i(5,"td"),n(6),t(),i(7,"td"),n(8),t(),i(9,"td"),n(10),t(),i(11,"td"),n(12),t(),i(13,"td")(14,"button",11),C("click",function(){let e=h(r).$implicit,l=g(3);return u(l.verHistorial(e.id))}),n(15,"Ver Historial"),t()()()}if(o&2){let r=c.$implicit;s(2),d(r.id),s(2),d(r.usuario.nombre),s(2),d(r.usuario.apellido),s(2),d(r.carnet),s(2),d(r.fechaNacimiento),s(2),d(r.usuario.email)}}function N(o,c){if(o&1&&(i(0,"table",9)(1,"thead")(2,"tr")(3,"th"),n(4,"ID"),t(),i(5,"th"),n(6,"Nombre"),t(),i(7,"th"),n(8,"Apellido"),t(),i(9,"th"),n(10,"Carnet"),t(),i(11,"th"),n(12,"Fecha de Nacimiento"),t(),i(13,"th"),n(14,"Email"),t(),i(15,"th"),n(16,"Acci\xF3n"),t()()(),i(17,"tbody"),f(18,A,16,6,"tr",10),t()()),o&2){let r=g(2);s(18),p("ngForOf",r.filteredPacientes)}}function L(o,c){if(o&1&&(i(0,"div",4)(1,"h1",5),n(2,"Pacientes Atendidos"),t(),f(3,T,2,0,"div",6)(4,N,19,1,"table",7),t()),o&2){let r=g();s(3),p("ngIf",r.filteredPacientes.length===0),s(),p("ngIf",r.filteredPacientes.length>0)}}var D=(()=>{let c=class c{constructor(a){this.http=a,this.pacientes=[],this.filteredPacientes=[],this.citas=[],this.isLoading=!1,this.medicoId=parseInt(localStorage.getItem("medicoId")||"0",10),console.log(this.medicoId)}ngOnInit(){this.loadCitas()}loadCitas(){this.isLoading=!0,this.http.get("http://143.198.147.110/api/citas").subscribe(a=>{this.citas=a.filter(e=>e.medicoId===this.medicoId&&e.estado==="atendida"),this.loadPacientes()},a=>{this.isLoading=!1,m.default.fire({title:"Error al cargar citas",text:"Por favor, int\xE9ntalo nuevamente.",icon:"error",confirmButtonText:"Aceptar"}),console.error("Error loading citas",a)})}loadPacientes(){this.http.get("http://143.198.147.110/api/pacientes").subscribe(a=>{let e=new Set(this.citas.map(l=>l.pacienteId));this.filteredPacientes=a.filter(l=>e.has(l.id)),this.isLoading=!1},a=>{this.isLoading=!1,m.default.fire({title:"Error al cargar pacientes",text:"Por favor, int\xE9ntalo nuevamente.",icon:"error",confirmButtonText:"Aceptar"}),console.error("Error loading pacientes",a)})}verHistorial(a){this.isLoading=!0,this.http.get(`http://143.198.147.110/api/historiales-clinicos/paciente/${a}`).subscribe(e=>{this.isLoading=!1,m.default.fire({title:`Historial Cl\xEDnico de ${e.pacienteNombre}`,html:`
            <p><strong>Fecha de Creaci\xF3n:</strong> ${e.fechaCreacion}</p>
            <p><strong>\xDAltima Actualizaci\xF3n:</strong> ${e.fechaUltimaActualizacion}</p>
            <p><strong>Notas:</strong> ${e.notas||"Sin notas"}</p>
            <a href="${e.archivoUrl}" target="_blank" class="text-blue-500 underline">Ver Archivo</a>
          `,icon:"info",confirmButtonText:"Cerrar"})},e=>{this.isLoading=!1,m.default.fire({title:"Error al cargar historial cl\xEDnico",text:"Por favor, int\xE9ntalo nuevamente.",icon:"error",confirmButtonText:"Aceptar"}),console.error("Error loading historial cl\xEDnico",e)})}};c.\u0275fac=function(e){return new(e||c)(_(O))},c.\u0275cmp=x({type:c,selectors:[["app-gestionar-pacientes"]],standalone:!0,features:[P],decls:2,vars:2,consts:[["class","spinner-container",4,"ngIf"],["class","container mx-auto px-4 py-8",4,"ngIf"],[1,"spinner-container"],[1,"spinner"],[1,"container","mx-auto","px-4","py-8"],[1,"text-2xl","font-bold","mb-4","text-center"],["class","text-center text-gray-600",4,"ngIf"],["class","table",4,"ngIf"],[1,"text-center","text-gray-600"],[1,"table"],[4,"ngFor","ngForOf"],[1,"bg-blue-500","text-white","px-4","py-2","rounded",3,"click"]],template:function(e,l){e&1&&f(0,w,2,0,"div",0)(1,L,5,2,"div",1),e&2&&(p("ngIf",l.isLoading),s(),p("ngIf",!l.isLoading))},dependencies:[S,E,I],styles:[".spinner-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#000c;display:flex;justify-content:center;align-items:center;z-index:1000}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid #ffffff;border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:20px}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #dee2e6;padding:12px;text-align:left}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f8f9fa}button[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-weight:700;cursor:pointer;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{opacity:.9}@media (max-width: 768px){table[_ngcontent-%COMP%]{font-size:14px}button[_ngcontent-%COMP%]{width:100%;margin-top:10px}}"]});let o=c;return o})();export{D as GestionarPacientesComponent};

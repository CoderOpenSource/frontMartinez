import{a as z}from"./chunk-VQFNXLW7.js";import{a as P,b as W,e as F,g as A,h as N,i as B,k as H}from"./chunk-BTD7GRPP.js";import{b as L}from"./chunk-ZBLQCJ4V.js";import{$a as M,Da as r,Ea as y,Ra as f,Rb as T,Sb as k,Ta as _,Ub as O,Va as t,Wa as i,Xa as S,_a as v,a as w,ab as s,ba as E,e as D,fb as l,gb as u,hb as C,ib as I,jb as g,ka as p,kb as x,la as m,lb as h,nb as V}from"./chunk-IG4KVHXC.js";var b=D(z());function G(a,c){a&1&&(t(0,"div",2),S(1,"div",3),i())}function q(a,c){a&1&&(t(0,"span"),l(1,", "),i())}function J(a,c){if(a&1&&(t(0,"span"),l(1),f(2,q,2,0,"span",17),i()),a&2){let n=c.$implicit,o=c.index,e=s().$implicit,d=s(2);r(),C(" ",d.getEspecialidadNombre(n),""),r(),_("ngIf",o<e.especialidadesIds.length-1)}}function K(a,c){if(a&1){let n=v();t(0,"tr",13)(1,"td",10),l(2),i(),t(3,"td",10),l(4),i(),t(5,"td",10),l(6),i(),t(7,"td",10),l(8),i(),t(9,"td",10),l(10),i(),t(11,"td",10),l(12),i(),t(13,"td",10),l(14),i(),t(15,"td",10),f(16,J,3,2,"span",14),i(),t(17,"td",10)(18,"button",15),M("click",function(){let e=p(n).$implicit,d=s(2);return m(d.editMedico(e.id))}),l(19," Editar "),i(),t(20,"button",16),M("click",function(){let e=p(n).$implicit,d=s(2);return m(d.deleteMedico(e.id))}),l(21," Eliminar "),i()()()}if(a&2){let n=c.$implicit;r(2),u(n.id),r(2),I("",n.nombre," ",n.apellido,""),r(2),u(n.ci),r(2),u(n.email),r(2),u(n.telefonoConsultorio),r(2),u(n.numeroLicencia),r(2),u(n.disponibilidad?"Activo":"Inactivo"),r(2),_("ngForOf",n.especialidadesIds)}}function Q(a,c){if(a&1){let n=v();t(0,"div",32)(1,"input",33),M("change",function(){let e=p(n).$implicit,d=s(3);return m(d.toggleEspecialidadSelection(e.id))}),i(),t(2,"span",34),l(3),i()()}if(a&2){let n=c.$implicit,o=s(3);r(),_("value",n.id)("checked",o.especialidadesIds.includes(n.id)),r(2),u(n.nombre)}}function R(a,c){if(a&1){let n=v();t(0,"div",18)(1,"div",19)(2,"h2",20),l(3),i(),t(4,"div",21)(5,"div")(6,"label",22),l(7,"Nombre"),i(),t(8,"input",23),h("ngModelChange",function(e){p(n);let d=s(2);return x(d.selectedMedico.nombre,e)||(d.selectedMedico.nombre=e),m(e)}),i()(),t(9,"div")(10,"label",22),l(11,"Apellido"),i(),t(12,"input",23),h("ngModelChange",function(e){p(n);let d=s(2);return x(d.selectedMedico.apellido,e)||(d.selectedMedico.apellido=e),m(e)}),i()()(),t(13,"div",21)(14,"div")(15,"label",22),l(16,"CI"),i(),t(17,"input",23),h("ngModelChange",function(e){p(n);let d=s(2);return x(d.selectedMedico.ci,e)||(d.selectedMedico.ci=e),m(e)}),i()(),t(18,"div")(19,"label",22),l(20,"Tel\xE9fono"),i(),t(21,"input",23),h("ngModelChange",function(e){p(n);let d=s(2);return x(d.selectedMedico.telefonoConsultorio,e)||(d.selectedMedico.telefonoConsultorio=e),m(e)}),i()()(),t(22,"div",21)(23,"div")(24,"label",22),l(25,"Email"),i(),t(26,"input",24),h("ngModelChange",function(e){p(n);let d=s(2);return x(d.selectedMedico.email,e)||(d.selectedMedico.email=e),m(e)}),i()(),t(27,"div")(28,"label",22),l(29,"N\xFAmero de Licencia"),i(),t(30,"input",23),h("ngModelChange",function(e){p(n);let d=s(2);return x(d.selectedMedico.numeroLicencia,e)||(d.selectedMedico.numeroLicencia=e),m(e)}),i()()(),t(31,"div",25)(32,"label",22),l(33,"Disponibilidad"),i(),t(34,"select",23),h("ngModelChange",function(e){p(n);let d=s(2);return x(d.selectedMedico.disponibilidad,e)||(d.selectedMedico.disponibilidad=e),m(e)}),t(35,"option",26),l(36,"Activo"),i(),t(37,"option",26),l(38,"Inactivo"),i()()(),t(39,"div",25)(40,"label",22),l(41,"Especialidades"),i(),t(42,"div",27),f(43,Q,4,3,"div",28),i()(),t(44,"div",29)(45,"button",30),M("click",function(){p(n);let e=s(2);return m(e.saveMedico())}),l(46),i(),t(47,"button",31),M("click",function(){p(n);let e=s(2);return m(e.closeModal())}),l(48," Cancelar "),i()()()()}if(a&2){let n=s(2);r(3),C(" ",n.isEditMode?"Editar M\xE9dico":"A\xF1adir M\xE9dico"," "),r(5),g("ngModel",n.selectedMedico.nombre),r(4),g("ngModel",n.selectedMedico.apellido),r(5),g("ngModel",n.selectedMedico.ci),r(4),g("ngModel",n.selectedMedico.telefonoConsultorio),r(5),g("ngModel",n.selectedMedico.email),r(4),g("ngModel",n.selectedMedico.numeroLicencia),r(4),g("ngModel",n.selectedMedico.disponibilidad),r(),_("ngValue",!0),r(2),_("ngValue",!1),r(6),_("ngForOf",n.especialidades),r(3),C(" ",n.isEditMode?"Actualizar":"Guardar"," ")}}function U(a,c){if(a&1){let n=v();t(0,"div",4)(1,"h1",5),l(2,"Gestionar M\xE9dicos"),i(),t(3,"div",6)(4,"button",7),M("click",function(){p(n);let e=s();return m(e.addMedico())}),l(5," A\xF1adir M\xE9dico "),i()(),t(6,"table",8)(7,"thead")(8,"tr",9)(9,"th",10),l(10,"ID"),i(),t(11,"th",10),l(12,"Nombre y Apellido"),i(),t(13,"th",10),l(14,"CI"),i(),t(15,"th",10),l(16,"Email"),i(),t(17,"th",10),l(18,"Tel\xE9fono"),i(),t(19,"th",10),l(20,"Licencia"),i(),t(21,"th",10),l(22,"Disponibilidad"),i(),t(23,"th",10),l(24,"Especialidades"),i(),t(25,"th",10),l(26,"Acciones"),i()()(),t(27,"tbody"),f(28,K,22,9,"tr",11),i()(),f(29,R,49,12,"div",12),i()}if(a&2){let n=s();r(28),_("ngForOf",n.medicos),r(),_("ngIf",n.showModal)}}var ie=(()=>{let c=class c{constructor(o){this.http=o,this.isLoading=!1,this.medicos=[],this.especialidades=[],this.selectedMedico={id:0,ci:"",nombre:"",apellido:"",email:"",especialidadesIds:[],telefonoConsultorio:"",numeroLicencia:"",disponibilidad:!0},this.especialidadesIds=[],this.showModal=!1,this.isEditMode=!1}ngOnInit(){this.loadMedicos(),this.loadEspecialidades()}loadMedicos(){this.isLoading=!0,this.http.get("http://143.198.147.110/api/medicos").subscribe(o=>{this.medicos=o,this.isLoading=!1},o=>{this.isLoading=!1,this.handleHttpError(o)})}loadEspecialidades(){this.isLoading=!0,this.http.get("http://143.198.147.110/api/especialidades").subscribe(o=>{this.especialidades=o,this.isLoading=!1},o=>{this.isLoading=!1,this.handleHttpError(o)})}getEspecialidadNombre(o){let e=this.especialidades.find(d=>d.id===o);return e?e.nombre:""}addMedico(){this.selectedMedico={id:0,ci:"",nombre:"",apellido:"",email:"",especialidadesIds:[],telefonoConsultorio:"",numeroLicencia:"",disponibilidad:!0},this.especialidadesIds=[],this.isEditMode=!1,this.showModal=!0}editMedico(o){let e=this.medicos.find(d=>d.id===o);e&&(this.selectedMedico=w({},e),this.especialidadesIds=e.especialidadesIds,this.isEditMode=!0,this.showModal=!0)}deleteMedico(o){b.default.fire({title:"\xBFEst\xE1s seguro?",text:"Esta acci\xF3n no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar"}).then(e=>{e.isConfirmed&&this.http.delete(`http://143.198.147.110/api/medicos/${o}`).subscribe(()=>{b.default.fire("Eliminado","El m\xE9dico ha sido eliminado correctamente.","success"),this.loadMedicos()},d=>{this.handleHttpError(d)})})}saveMedico(){let o={ci:this.selectedMedico.ci,nombre:this.selectedMedico.nombre,apellido:this.selectedMedico.apellido,email:this.selectedMedico.email,telefonoConsultorio:this.selectedMedico.telefonoConsultorio,numeroLicencia:this.selectedMedico.numeroLicencia,disponibilidad:this.selectedMedico.disponibilidad,especialidadesIds:this.especialidadesIds},e=this.isEditMode?`http://143.198.147.110/api/medicos/${this.selectedMedico.id}`:"http://143.198.147.110/api/medicos";(this.isEditMode?this.http.put(e,o):this.http.post(e,o)).subscribe(()=>{b.default.fire("Guardado",`M\xE9dico ${this.isEditMode?"actualizado":"creado"} correctamente.`,"success"),this.loadMedicos(),this.showModal=!1},j=>{this.handleHttpError(j)})}toggleEspecialidadSelection(o){let e=this.especialidadesIds.indexOf(o);e===-1?this.especialidadesIds.push(o):this.especialidadesIds.splice(e,1)}closeModal(){this.showModal=!1}handleHttpError(o){o.status===401?b.default.fire({title:"Sesi\xF3n expirada",text:"Tu sesi\xF3n ha expirado. Por favor, inicia sesi\xF3n nuevamente.",icon:"warning",confirmButtonText:"Aceptar",allowOutsideClick:!1}).then(e=>{e.isConfirmed&&(localStorage.clear(),window.location.href="/login")}):(b.default.fire("Error","Ha ocurrido un error. Int\xE9ntalo nuevamente.","error"),console.error("HTTP Error:",o))}};c.\u0275fac=function(e){return new(e||c)(y(L))},c.\u0275cmp=E({type:c,selectors:[["app-medicos"]],standalone:!0,features:[V],decls:2,vars:2,consts:[["class","spinner-container",4,"ngIf"],["class","container mx-auto px-4 py-8",4,"ngIf"],[1,"spinner-container"],[1,"spinner"],[1,"container","mx-auto","px-4","py-8"],[1,"text-3xl","font-bold","mb-8","text-center","text-gray-800"],[1,"flex","justify-center","mb-6"],[1,"bg-green-500","text-white","px-4","py-2","rounded-lg","hover:bg-green-600",3,"click"],[1,"min-w-full","bg-white","shadow-lg","rounded-lg","border-collapse"],[1,"bg-gray-800","text-white"],[1,"p-4","border"],["class","hover:bg-gray-100",4,"ngFor","ngForOf"],["class","fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 flex items-center justify-center",4,"ngIf"],[1,"hover:bg-gray-100"],[4,"ngFor","ngForOf"],[1,"bg-blue-500","text-white","px-3","py-1","rounded","hover:bg-blue-600","mr-2",3,"click"],[1,"bg-red-500","text-white","px-3","py-1","rounded","hover:bg-red-600",3,"click"],[4,"ngIf"],[1,"fixed","top-0","left-0","w-full","h-full","bg-black","bg-opacity-50","flex","items-center","justify-center"],[1,"bg-white","p-6","rounded-lg","shadow-md","w-full","max-w-lg"],[1,"text-2xl","font-bold","mb-4","text-center"],[1,"mb-4","grid","grid-cols-1","sm:grid-cols-2","gap-4"],[1,"block","font-bold","text-gray-700","mb-1"],[1,"w-full","px-3","py-2","border","rounded-lg","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["type","email",1,"w-full","px-3","py-2","border","rounded-lg","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],[1,"mb-4"],[3,"ngValue"],[1,"grid","grid-cols-2","gap-4"],["class","flex items-center",4,"ngFor","ngForOf"],[1,"flex","justify-between","mt-4"],[1,"bg-blue-500","text-white","px-4","py-2","rounded-lg","hover:bg-blue-600",3,"click"],[1,"bg-gray-500","text-white","px-4","py-2","rounded-lg","hover:bg-gray-600",3,"click"],[1,"flex","items-center"],["type","checkbox",3,"change","value","checked"],[1,"ml-2"]],template:function(e,d){e&1&&f(0,G,2,0,"div",0)(1,U,30,2,"div",1),e&2&&(_("ngIf",d.isLoading),r(),_("ngIf",!d.isLoading))},dependencies:[O,T,k,H,N,B,P,A,W,F],styles:[".spinner-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#000c;display:flex;justify-content:center;align-items:center;z-index:1000}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid #ffffff;border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:20px}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #dee2e6;padding:12px;text-align:left}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f8f9fa}button[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-weight:700;cursor:pointer;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{opacity:.9}@media (max-width: 768px){table[_ngcontent-%COMP%]{font-size:14px}button[_ngcontent-%COMP%]{width:100%;margin-top:10px}}"]});let a=c;return a})();export{ie as MedicosComponent};
